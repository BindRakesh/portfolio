<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rakesh's 3D Portfolio</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: sans-serif; }
        #info {
            position: absolute;
            top: 20px;
            width: 100%;
            text-align: center;
            color: white;
            pointer-events: none;
            text-shadow: 1px 1px 2px black;
        }
        /* Simple modal for content display */
        #modal {
            display: none;
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 20px;
            border-radius: 8px;
            max-width: 400px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        #modal h2 { margin-top: 0; }
        button { cursor: pointer; padding: 5px 10px; }
    </style>
</head>
<body>

    <div id="info">Click on the <b>Monitor</b> for Skills or the <b>Laptop</b> for About Me</div>
    
    <div id="modal">
        <h2 id="modal-title">Title</h2>
        <p id="modal-content">Content goes here...</p>
        <button onclick="document.getElementById('modal').style.display='none'">Close</button>
    </div>

    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
            }
        }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // 1. SCENE SETUP
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x202025); // Dark office background

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(0, 2.5, 4); // Position camera to look down at desk

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true; // Enable shadows
        document.body.appendChild(renderer.domElement);

        // Controls
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.target.set(0, 1, 0);

        // Lighting
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);

        const dirLight = new THREE.DirectionalLight(0xffffff, 1);
        dirLight.position.set(5, 10, 7);
        dirLight.castShadow = true;
        scene.add(dirLight);

        // 2. BUILD THE OFFICE (BLOCK-OUT)
        
        // Material Helpers
        const woodMat = new THREE.MeshStandardMaterial({ color: 0x8B4513 });
        const darkMat = new THREE.MeshStandardMaterial({ color: 0x1a1a1a });
        const screenMat = new THREE.MeshStandardMaterial({ color: 0x4488ff, emissive: 0x112244 }); // Glowing screen
        const metalMat = new THREE.MeshStandardMaterial({ color: 0x888888 });

        const interactableObjects = [];

        // -- The Desk --
        const deskGeo = new THREE.BoxGeometry(4, 0.1, 2);
        const desk = new THREE.Mesh(deskGeo, woodMat);
        desk.position.y = 1;
        desk.receiveShadow = true;
        scene.add(desk);

        // -- The Monitor (Primary Interaction) --
        const monitorGroup = new THREE.Group();
        
        // Stand
        const standGeo = new THREE.CylinderGeometry(0.05, 0.05, 0.5);
        const stand = new THREE.Mesh(standGeo, metalMat);
        stand.position.y = 1.25;
        
        // Screen Frame
        const monitorFrameGeo = new THREE.BoxGeometry(1.5, 0.9, 0.05);
        const monitorFrame = new THREE.Mesh(monitorFrameGeo, darkMat);
        monitorFrame.position.y = 1.6;

        // The Actual Screen (Clickable)
        const screenGeo = new THREE.BoxGeometry(1.4, 0.8, 0.06);
        const monitorScreen = new THREE.Mesh(screenGeo, screenMat);
        monitorScreen.position.y = 1.6;
        monitorScreen.name = "Monitor"; // IMPORTANT for click logic
        monitorGroup.add(stand, monitorFrame, monitorScreen);
        monitorGroup.position.set(0, 0, -0.5);
        
        scene.add(monitorGroup);
        interactableObjects.push(monitorScreen);

        // -- The Laptop (Secondary Interaction) --
        const laptopGroup = new THREE.Group();
        
        // Base
        const lapBase = new THREE.Mesh(new THREE.BoxGeometry(0.8, 0.05, 0.6), metalMat);
        
        // Lid (Open)
        const lapLid = new THREE.Mesh(new THREE.BoxGeometry(0.8, 0.05, 0.6), metalMat);
        lapLid.position.set(0, 0.025, -0.3);
        lapLid.rotation.x = Math.PI / 4; // Open lid angle
        
        // Laptop Screen (Clickable)
        const lapScreen = new THREE.Mesh(new THREE.PlaneGeometry(0.7, 0.5), screenMat);
        lapScreen.position.set(0, 0.06, -0.35);
        lapScreen.rotation.x = Math.PI / 4 - 0.1; // Slightly offset from lid
        lapScreen.name = "Laptop";
        
        laptopGroup.add(lapBase, lapLid, lapScreen);
        laptopGroup.position.set(1.2, 1.05, 0.3);
        laptopGroup.rotation.y = -0.5; // Angled toward user
        scene.add(laptopGroup);
        interactableObjects.push(lapScreen);

        // -- The Chair --
        const chairSeat = new THREE.Mesh(new THREE.BoxGeometry(1, 0.1, 1), darkMat);
        chairSeat.position.set(0, 0.5, 1.5);
        const chairBack = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 0.1), darkMat);
        chairBack.position.set(0, 1, 2);
        scene.add(chairSeat, chairBack);


        // 3. RAYCASTING (CLICK LOGIC)
        const raycaster = new THREE.Raycaster();
        const pointer = new THREE.Vector2();

        window.addEventListener('click', (event) => {
            // Calculate pointer position in normalized device coordinates (-1 to +1)
            pointer.x = (event.clientX / window.innerWidth) * 2 - 1;
            pointer.y = -(event.clientY / window.innerHeight) * 2 + 1;

            // Update the picking ray with the camera and pointer position
            raycaster.setFromCamera(pointer, camera);

            // Calculate objects intersecting the picking ray
            const intersects = raycaster.intersectObjects(interactableObjects);

            if (intersects.length > 0) {
                const objectName = intersects[0].object.name;
                handleInteraction(objectName);
            }
        });

        function handleInteraction(name) {
            const modal = document.getElementById('modal');
            const title = document.getElementById('modal-title');
            const content = document.getElementById('modal-content');

            modal.style.display = 'block';

            if (name === "Monitor") {
                title.innerText = "Work Skills";
                content.innerHTML = `
                    <ul>
                        <li><b>Web Development:</b> HTML, CSS, JavaScript</li>
                        <li><b>Backend:</b> Python, Node.js</li>
                        <li><b>Tools:</b> Three.js, React, GitHub</li>
                        <li><b>Specialty:</b> Creating interactive 3D experiences.</li>
                    </ul>
                `;
            } else if (name === "Laptop") {
                title.innerText = "About Me";
                content.innerHTML = "Hi, I'm Rakesh. I am a passionate developer who loves bridging the gap between design and engineering. Currently focused on 3D web technologies.";
            }
        }

        // 4. ANIMATION LOOP
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        // Handle Window Resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>
